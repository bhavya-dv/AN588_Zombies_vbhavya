---
title: "Homework 3: Some of my best friends are zombies!"
author: "Bhavya Deepti Vadavalli"
date: "2023-10-09"
output:
  rmdformats::readthedown:
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r zombiegir, echo=FALSE, out.width = '50%'}
knitr::include_graphics("gggdrible.gif")
```

# Preliminaries: 

1. Installing and getting needed packages into the environment 
2. Importing the dataset into the environment. 

```{r preliminaries}
library(curl)
library(ggplot2) #I would've just called library(tidyverse) but R is telling me to update and I really don't want to. R updates terrify me.  
library(rmdformats)


f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN588_Fall23/zombies.csv") #importing the zombies data set from Chris' github
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE)
head(d)
```

# Assignment problems

## Question 1: Calculating the population means and standard deviations. 

var() and sd() commands as these are for samples. 
Therefore, I made a function stdev() to calculate standard deviation of the population, using population mean and n (from length(d$variable))

```{r problem1}

#writing a function for population standard deviation of variable y 
stdev <- function(y) {
  sqrt(sum((y - mean(y))^2)/length(y))}

#height
mean(d$height) 
stdev(d$height)

#weight
mean(d$weight) 
stdev(d$weight)

#No. of zombies killed
mean(d$zombies_killed) 
stdev(d$zombies_killed)

#Years of education
mean(d$years_of_education)
stdev(d$years_of_education)

#Age
mean(d$age)
stdev(d$age)
```
## Question 2: Use {ggplot} to make boxplots of each of these variables by gender.

```{r problem2}

# Variable = height
p <- ggplot(data = d, aes(x = gender, y = height,
    color = factor(gender))) + geom_boxplot()
p

# Variable = weight
p <- ggplot(data = d, aes(x = gender, y = weight,
    color = factor(gender))) + geom_boxplot()
p

# Variable = age
p <- ggplot(data = d, aes(x = gender, y = age,
    color = factor(gender))) + geom_boxplot()
p

# Variable = No of zombies killed
p <- ggplot(data = d, aes(x = gender, y = zombies_killed,
    color = factor(gender))) + geom_boxplot()
p

# Variable = Years of education
p <- ggplot(data = d, aes(x = gender, y = years_of_education,
    color = factor(gender))) + geom_boxplot()
p
```

## Question 3: Use {ggplot} to make scatterplots of height and weight in relation to age. Do these variables seem to be related? In what way?

```{r problem3}
#Age v/s height

p <- ggplot(data = d, aes(x = age, y = height)) + geom_point()
p

#Age v/s weight

p <- ggplot(data = d, aes(x = age, y = weight)) + geom_point()
p
```
Yes, there seems to be a positive correlation between age and both height and weight. This means, as age increases, both height and weight are likely to increase as well. 

However, the relationship between age and height seems to be more correlated upto 25 years of age, after which it flattens. 

The relationship between age and weight is much more linear, but seems to have a lot of scatter around where a best-fit regression would be. 

## Question 4: Using histograms and Q-Q plots, check whether the quantitative variables seem to be drawn from a normal distribution. Which seem to be and which do not (hint: not all are drawn from the normal distribution)? For those that are not normal, can you determine from which common distribution they are drawn?

```{r problem4}

#Variable = weight
hist(d$weight, probability = TRUE)
qqnorm(d$weight, main = "Normal QQ plot for weight of individuals")  
qqline(d$weight, col = "gray") # fits with the QQ-line quite well (except the tails), can be roughly estimated to a normal distribution

#Variable = height
hist(d$height, probability = TRUE)
qqnorm(d$height, main = "Normal QQ plot for height of individuals") 
qqline(d$height, col = "gray") # fits with the QQ-line very well. Very normally distributed. 

#Variable = age
hist(d$age, probability = TRUE)
qqnorm(d$age, main = "Normal QQ plot for age of individuals") 
qqline(d$age, col = "gray") # fits with the QQ-line quite well (except the tails), can be roughly estimated to a normal distribution

#Variable = No. of zombies killed
hist(d$zombies_killed, probability = TRUE) #not a normal distribution
qqnorm(d$zombies_killed, main = "QQ plot for no. of zombies killed by individuals") 
qqline(d$zombies_killed, col = "gray") # Not a normal distribution

#Variable = years of education
hist(d$years_of_education, probability = TRUE) #not a normal distribution
qqnorm(d$years_of_education, main = "QQ plot for years of education of individuals")  
qqline(d$years_of_education, col = "gray") # Not a normal distribution
```

Age, height and weight seem to be the variables that are derived from normal distributions. Their histograms are bell-shaped curves and the points align with the QQ-norm line well. Some deviation is expected at the extremes. 

However, neither the "zombies_killed" nor the "years of education" variable was normally distributed. I would guess that these variables are poisson distributed, where the random variable X is the number of zombies killed, or the years or education respectively. This is also echoed in the qq-plots. 

## Question 5: Now use the sample() function to sample ONE subset of 30 zombie survivors (without replacement) from this population and calculate the mean and sample standard deviation for each variable. Also estimate the standard error for each variable, and construct the 95% confidence interval for each mean.

```{r problem5.1}
#creating a different sample (n=30) for each variable

sampledat <- function(x) {
  sample(x, size = 30, replace = FALSE)
}

#For variable = weight 
s<- sampledat(d$weight)
m <- mean(s) 
sd(s) #can use this now because this is a sample not population? 
sem <- sd(s)/sqrt(30)
lower <- m - qnorm(1 - 0.05/2) * sem  #because this is from a normal distribution
upper <- m + qnorm(1 - 0.05/2) * sem  
ci <- c(lower, upper)
ci

#For variable = height 
s<- sampledat(d$height)
m <- mean(s) 
sd(s) #can use this now because this is a sample not population? 
sem <- sd(s)/sqrt(30)
lower <- m - qnorm(1 - 0.05/2) * sem  #because this is from a normal distribution
upper <- m + qnorm(1 - 0.05/2) * sem  
ci <- c(lower, upper)
ci

#For variable = age 
s<- sampledat(d$age)
m <- mean(s) 
sd(s) #can use this now because this is a sample not population? 
sem <- sd(s)/sqrt(30)
lower <- m - qnorm(1 - 0.05/2) * sem  #because this is from a normal distribution
upper <- m + qnorm(1 - 0.05/2) * sem  
ci <- c(lower, upper)
ci
```

For the variables above that are from a normal distribution, the way to calculate the 95% CI is pretty straightforward. However, for variables like "zombies_killed" or "years_of_"education", which I suspect are from a poisson distribution each, we can use the Central Limit Theorem to make normal approximations of the poisson distributions. These can then be used to find the 95% CIs for the variables. 

```{r problem5.clt}
# Variable: Zombies killed
lambda <- mean(d$zombies_killed)
stdev <- sqrt(lambda)

#normal approximation:
norm_zombies_killed <- rnorm(n=1000, mean = lambda, sd = stdev)
hist(norm_zombies_killed, probability = TRUE) #looks like a normal distribution now
#norm_zombies_killed is our new population for zombies_killed now, which is normally approximated

s<- sampledat(norm_zombies_killed)
m <- mean(s) 
sd(s) #can use this now because this is a sample not population? 
sem <- sd(s)/sqrt(30)
lower <- m - qnorm(1 - 0.05/2) * sem  #because this is from a normal distribution
upper <- m + qnorm(1 - 0.05/2) * sem  
ci <- c(lower, upper)
ci #CI for norm_zombies_killed

# Variable: years of education
lambda <- mean(d$years_of_education)
stdev <- sqrt(lambda)

#normal approximation:
norm_years_of_edu <- rnorm(n=1000, mean = lambda, sd = stdev)
hist(norm_years_of_edu, probability = TRUE) #looks like a normal distribution now
#norm_years_of_edu is our new population for years_of_education now, which is normally approximated

s<- sampledat(norm_years_of_edu)
m <- mean(s) 
sd(s) #can use this now because this is a sample not population? 
sem <- sd(s)/sqrt(30)
lower <- m - qnorm(1 - 0.05/2) * sem  #because this is from a normal distribution
upper <- m + qnorm(1 - 0.05/2) * sem  
ci <- c(lower, upper)
ci #CI for norm_years_of_edu

```